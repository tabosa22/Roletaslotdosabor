<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roleta Slot do Sabor</title>
<style>
body {
    background-color: #8B0000;
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
    color: white;
}
h1 {
    margin-top: 20px;
}
canvas {
    background-color: #8B0000;
    border-radius: 50%;
}
#spin {
    background-color: gold;
    border: none;
    padding: 15px 30px;
    font-size: 20px;
    border-radius: 10px;
    cursor: pointer;
    margin-top: 20px;
    font-weight: bold;
}
#result {
    font-size: 22px;
    margin-top: 20px;
    font-weight: bold;
}
#whatsapp {
    background-color: #25D366;
    color: white;
    border: none;
    padding: 12px 20px;
    font-size: 18px;
    border-radius: 8px;
    cursor: pointer;
    margin-top: 15px;
    display: none;
}
</style>
</head>
<body>

<h1>ðŸŽ° Roleta Slot do Sabor</h1>
<canvas id="canvas" width="400" height="400"></canvas>
<button id="spin">Girar</button>
<div id="result"></div>
<button id="whatsapp">Resgatar no WhatsApp</button>

<script>
const options = [
    "Batata grÃ¡tis",
    "10% de desconto",
    "1 Dragon double cheddar",
    "SÃ³ na prÃ³xima",
    "AÃ§aÃ­ de 300ml",
    "Refrigerante grÃ¡tis"
];

let startAngle = 0;
const arc = Math.PI / (options.length / 2);
let spinTimeout = null;
let spinAngleStart = 0;
let spinTime = 0;
let spinTimeTotal = 0;

const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

function drawRouletteWheel() {
    const outsideRadius = 180;
    const textRadius = 140;
    const insideRadius = 60;

    ctx.clearRect(0, 0, 400, 400);

    ctx.strokeStyle = "black";
    ctx.lineWidth = 2;
    ctx.font = 'bold 14px Arial';

    for (let i = 0; i < options.length; i++) {
        const angle = startAngle + i * arc;
        ctx.fillStyle = i % 2 === 0 ? "#FFD700" : "#FF4500";

        ctx.beginPath();
        ctx.arc(200, 200, outsideRadius, angle, angle + arc, false);
        ctx.arc(200, 200, insideRadius, angle + arc, angle, true);
        ctx.stroke();
        ctx.fill();

        ctx.save();
        ctx.fillStyle = "black";
        ctx.translate(
            200 + Math.cos(angle + arc / 2) * textRadius,
            200 + Math.sin(angle + arc / 2) * textRadius
        );
        ctx.rotate(angle + arc / 2);
        const text = options[i];
        ctx.fillText(text, -ctx.measureText(text).width / 2, 0);
        ctx.restore();
    }

    // seta
    ctx.fillStyle = "black";
    ctx.beginPath();
    ctx.moveTo(200 - 4, 200 - (outsideRadius + 10));
    ctx.lineTo(200 + 4, 200 - (outsideRadius + 10));
    ctx.lineTo(200 + 4, 200 - (outsideRadius - 10));
    ctx.lineTo(200 + 9, 200 - (outsideRadius - 10));
    ctx.lineTo(200 + 0, 200 - (outsideRadius - 22));
    ctx.lineTo(200 - 9, 200 - (outsideRadius - 10));
    ctx.lineTo(200 - 4, 200 - (outsideRadius - 10));
    ctx.lineTo(200 - 4, 200 - (outsideRadius + 10));
    ctx.fill();

    // logo central
    const logoImg = new Image();
    logoImg.src = "data:image/png;base64,iVBORw0KGgoAAAANSR0IArs4c6QAAIABJREFUeF7svQe4nVd55/v7etn17FOlo15sybIs414Amw42GGzAGWrCUGzHkxCnMJknDZKpN4HcZDIkkDKUSegOGDDdDVu2JcuWZKtLVj1Fp+2+99..."; // (Base64 cortado aqui para caber)
    logoImg.onload = function() {
        ctx.save();
        ctx.beginPath();
        ctx.arc(200, 200, insideRadius - 5, 0, 2 * Math.PI, false);
        ctx.clip();
        ctx.drawImage(logoImg, 200 - (insideRadius - 5), 200 - (insideRadius - 5), (insideRadius - 5) * 2, (insideRadius - 5) * 2);
        ctx.restore();
    };
}

function rotateWheel() {
    spinTime += 30;
    if (spinTime >= spinTimeTotal) {
        stopRotateWheel();
        return;
    }
    const spinAngle = spinAngleStart - easeOut(spinTime, 0, spinAngleStart, spinTimeTotal);
    startAngle += (spinAngle * Math.PI / 180);
    drawRouletteWheel();
    spinTimeout = setTimeout(rotateWheel, 30);
}

function stopRotateWheel() {
    clearTimeout(spinTimeout);
    const degrees = startAngle * 180 / Math.PI + 90;
    const arcd = arc * 180 / Math.PI;
    const index = Math.floor((360 - (degrees % 360)) / arcd);
    const prize = options[index];

    document.getElementById("result").innerHTML = "ðŸŽ‰ VocÃª ganhou: " + prize + "!";
    document.getElementById("whatsapp").style.display = "inline-block";
    document.getElementById("whatsapp").onclick = function() {
        window.open(`https://wa.me/5521972700203?text=Ol%C3%A1,%20ganhei%20${encodeURIComponent(prize)}%20na%20Roleta%20do%20Slot%20do%20Sabor`, "_blank");
    };
}

function easeOut(t, b, c, d) {
    const ts = (t/=d)*t;
    const tc = ts*t;
    return b+c*(tc + -3*ts + 3*t);
}

document.getElementById("spin").addEventListener("click", function() {
    spinAngleStart = Math.random() * 10 + 10;
    spinTime = 0;
    spinTimeTotal = Math.random() * 3000 + 4000;
    rotateWheel();
});

drawRouletteWheel();
</script>

</body>
</html>
